<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>使用Hexo+Volantis搭建精美博客</title>
      <link href="/post/4b16ba9e.html"/>
      <url>/post/4b16ba9e.html</url>
      
        <content type="html"><![CDATA[<p>Volantis，一个高度模块化和可定制化、功能相对完善的 Hexo 博客主题，既可以用作个人博客，也适合用来搭建文档。</p><a id="more"></a><h2 id="一、环境要求"><a href="#一、环境要求" class="headerlink" title="一、环境要求"></a>一、环境要求</h2><p>如果您从旧版本更新或着其它主题迁移，请确保环境版本不要太低，否则会产生兼容性问题。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Hexo: 4.2</span><br><span class="line">hexo-cli: 3.1</span><br><span class="line">node.js: 12.16 # LTS版</span><br><span class="line">npm: 6.13</span><br></pre></td></tr></table></figure><h2 id="二、下载与安装"><a href="#二、下载与安装" class="headerlink" title="二、下载与安装"></a>二、下载与安装</h2><p><strong>第 1/3 步：下载主题源码到 themes/ 文件夹</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;volantis-x&#x2F;hexo-theme-volantis themes&#x2F;volantis</span><br><span class="line"></span><br><span class="line"># 或者使用国内镜像</span><br><span class="line">git clone https:&#x2F;&#x2F;e.coding.net&#x2F;volantis&#x2F;volantis&#x2F;volantis.git themes&#x2F;volantis</span><br></pre></td></tr></table></figure><p><strong>第 2/3 步：修改站点配置文件</strong></p><blockquote><p>blog/_config.yml</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme: volantis</span><br></pre></td></tr></table></figure><p><strong>第 3/3 步：检查并安装依赖</strong></p><blockquote><p>安装 Hexo 搜索的依赖包：</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -S hexo-generator-search hexo-generator-json-content</span><br></pre></td></tr></table></figure><blockquote><p>安装 stylus 渲染器：</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -S hexo-renderer-stylus</span><br></pre></td></tr></table></figure><h2 id="三、主题配置"><a href="#三、主题配置" class="headerlink" title="三、主题配置"></a>三、主题配置</h2><p>参考 <a href="https://volantis.js.org" target="_blank" rel="noopener">https://volantis.js.org</a></p><h2 id="1、设置导航栏"><a href="#1、设置导航栏" class="headerlink" title="1、设置导航栏"></a>1、设置导航栏</h2><p><strong>新建一个文件，专门存放导航栏菜单配置，文件的路径为：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blog&#x2F;source&#x2F;_data&#x2F;menu.yml</span><br></pre></td></tr></table></figure><p><strong>文件的内容为：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">- name: 主页</span><br><span class="line">  icon: fas fa-rss</span><br><span class="line">  url: &#x2F;</span><br><span class="line">- name: 分类</span><br><span class="line">  icon: fas fa-folder-open</span><br><span class="line">  url: categories&#x2F;</span><br><span class="line">- name: 标签</span><br><span class="line">  icon: fas fa-tags</span><br><span class="line">  url: tags&#x2F;</span><br><span class="line">- name: 归档</span><br><span class="line">  icon: fas fa-archive</span><br><span class="line">  url: archives&#x2F;</span><br><span class="line">- name: 更多</span><br><span class="line">  icon: fas fa-ellipsis-v</span><br><span class="line">  rows:</span><br><span class="line">    - name: 主题源码</span><br><span class="line">      url: https:&#x2F;&#x2F;github.com&#x2F;volantis-x&#x2F;hexo-theme-volantis&#x2F;</span><br><span class="line">    - name: 更新日志</span><br><span class="line">      url: https:&#x2F;&#x2F;github.com&#x2F;volantis-x&#x2F;hexo-theme-volantis&#x2F;releases&#x2F;</span><br><span class="line">    - name: hr</span><br><span class="line">    - name: 有疑问？</span><br><span class="line">      rows:</span><br><span class="line">        - name: 看 FAQ</span><br><span class="line">          url: faqs&#x2F;</span><br><span class="line">        - name: 看 本站源码</span><br><span class="line">          url: https:&#x2F;&#x2F;github.com&#x2F;volantis-x&#x2F;volantis-docs&#x2F;</span><br><span class="line">        - name: 提 Issue</span><br><span class="line">          url: https:&#x2F;&#x2F;github.com&#x2F;volantis-x&#x2F;hexo-theme-volantis&#x2F;issues&#x2F;</span><br><span class="line">    - name: hr</span><br><span class="line">    - name: 公告和测试博文</span><br><span class="line">      url: archives&#x2F;</span><br><span class="line">    - name: 示例博客</span><br><span class="line">      url: examples&#x2F;</span><br><span class="line">    - name: 特别感谢</span><br><span class="line">      url: contributors&#x2F;</span><br></pre></td></tr></table></figure><h2 id="2、播放器"><a href="#2、播放器" class="headerlink" title="2、播放器"></a>2、播放器</h2><p><strong>在子菜单中，新增一个 icon: fas fa-compact-disc 的“菜单”就会被渲染成一个 APlayer 播放器</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- name: 背景音乐</span><br><span class="line">  icon: fas fa-compact-disc</span><br></pre></td></tr></table></figure><h2 id="3、模块化布局"><a href="#3、模块化布局" class="headerlink" title="3、模块化布局"></a>3、模块化布局</h2><p><strong>可以自由决定每个页面是否显示侧边栏，侧边栏显示什么小部件，正文区域显示什么卡片，文章卡片显示什么 meta 信息。</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># The following can be written in &#96;blog&#x2F;source&#x2F;_data&#x2F;layout.yml&#96;</span><br><span class="line"># 文章列表（主页、自定义的列表）布局</span><br><span class="line">on_list:</span><br><span class="line">  # 列表中每一篇文章的meta信息</span><br><span class="line">  meta: [title, author, category, date, wordcount, counter, valinecount, pin]</span><br><span class="line">  # 列表类页面的侧边栏</span><br><span class="line">  sidebar: [blogger, category, tagcloud, qrcode]</span><br><span class="line">  # read more button</span><br><span class="line">  readmore: 阅读全文 &lt;i class&#x3D;&quot;fas fa-chevron-right&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class="line"># 页面布局</span><br><span class="line">on_page:</span><br><span class="line">  # 文章页面主体元素，你也可以在页面的Front-matter中设置</span><br><span class="line">  body: [article, comments]</span><br><span class="line">  # 默认的meta信息，文章中没有配置则按照这里的配置来显示，设置为false则不显示</span><br><span class="line">  # 其中，title只在header中有效，music和thumbnail无需在这里设置，文章中有则显示</span><br><span class="line">  # 如果tags放置在meta.header中，那么在post列表中不显示（因为卡片下方已经有了）</span><br><span class="line">  meta:</span><br><span class="line">    header: [title, author, category, date, pin]</span><br><span class="line">    footer: [updated, tags, btns, share]</span><br><span class="line">  # 文章页面的侧边栏</span><br><span class="line">  sidebar: [qrcode, toc]</span><br><span class="line"># 文章布局，参数继承自 on_page</span><br><span class="line">on_post:</span><br><span class="line">  # 文章页脚，自动在每一篇文章末尾添加</span><br><span class="line">  article_footer: [references, related_repos, copyright, donate]</span><br><span class="line"># 其他的页面布局暂时等于 on_list</span><br></pre></td></tr></table></figure><h2 id="4、配置文章作者信息"><a href="#4、配置文章作者信息" class="headerlink" title="4、配置文章作者信息"></a>4、配置文章作者信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># meta library</span><br><span class="line">meta:</span><br><span class="line">  # 文章标题</span><br><span class="line">  title: # 暂无配置</span><br><span class="line">  # 默认文章作者（可在front-matter中覆盖）</span><br><span class="line">  author:</span><br><span class="line">    avatar: &#x2F;assets&#x2F;avatar.jpg</span><br><span class="line">    name: Mr.L</span><br><span class="line">    url: &#x2F;</span><br></pre></td></tr></table></figure><h2 id="5、页面配置"><a href="#5、页面配置" class="headerlink" title="5、页面配置"></a>5、页面配置</h2><p><strong>如无特殊说明，本页面的配置信息写在 页面 文件的 front-matter 中。</strong></p><h2 id="6、布局模板"><a href="#6、布局模板" class="headerlink" title="6、布局模板"></a>6、布局模板</h2><table><thead><tr><th>取值</th><th>含义</th></tr></thead><tbody><tr><td>page</td><td>独立页面</td></tr><tr><td>post</td><td>文章页面</td></tr><tr><td>category</td><td>分类页面</td></tr><tr><td>tag</td><td>标签页面</td></tr><tr><td>links</td><td>友链页面</td></tr><tr><td>list</td><td>列表页面</td></tr></tbody></table><h2 id="7、front-matter"><a href="#7、front-matter" class="headerlink" title="7、front-matter"></a>7、front-matter</h2><p><strong>front-matter 是文件最上方以 — 分隔的区域，用于指定个别文件的变量</strong></p><table><thead><tr><th>字段</th><th>含义</th><th>值类型</th><th>默认值</th></tr></thead><tbody><tr><td>layout</td><td>布局模版</td><td>tring</td><td>-</td></tr><tr><td>title</td><td>页面标题</td><td>String</td><td>-</td></tr><tr><td>seo_title</td><td>网页标题</td><td>String</td><td>page.title</td></tr><tr><td>short_title</td><td>页面标题（在group列表中显示）</td><td>String</td><td>page.title</td></tr><tr><td>date</td><td>创建时间</td><td>Date</td><td>文件创建时间</td></tr><tr><td>updated</td><td>更新日期</td><td>Date</td><td>文件修改时间</td></tr><tr><td>permalink</td><td>覆盖文章网址</td><td>String</td><td>-</td></tr><tr><td>music</td><td>内部音乐控件</td><td>[Object]</td><td>-</td></tr><tr><td>robots</td><td>robots</td><td>String</td><td>-</td></tr><tr><td>keywords</td><td>页面关键词</td><td>String</td><td>-</td></tr><tr><td>description</td><td>页面描述、摘要</td><td>String</td><td>-</td></tr><tr><td>cover</td><td>是否显示封面</td><td>Bool</td><td>true</td></tr><tr><td>meta</td><td>文章或页面的meta信息</td><td>Bool, Array</td><td>theme.layout.*.meta</td></tr><tr><td>sidebar</td><td>页面侧边栏</td><td>Bool, Array</td><td>theme.layout.*.sidebar</td></tr><tr><td>body</td><td>页面主体元素</td><td>Array</td><td>theme.layout.on_page.body</td></tr><tr><td>mathjax</td><td>是否渲染公式</td><td>Bool, String</td><td>false</td></tr><tr><td>thumbnail</td><td>缩略图</td><td>String</td><td>false</td></tr><tr><td>icons</td><td>图标</td><td>Array</td><td>[]</td></tr><tr><td>pin</td><td>是否置顶</td><td>Bool, String</td><td>false</td></tr></tbody></table><p><strong>layout:post 时特有的字段：</strong></p><table><thead><tr><th>字段</th><th>含义</th><th>值类型</th><th>默认值</th></tr></thead><tbody><tr><td>author</td><td>文章作者</td><td>[Object]</td><td>config.author</td></tr><tr><td>categories</td><td>分类</td><td>String, Array</td><td>-</td></tr><tr><td>tags</td><td>标签</td><td>String, Array</td><td>-</td></tr><tr><td>toc</td><td>是否生成目录</td><td>Bool</td><td>true</td></tr></tbody></table><p><strong>author</strong></p><table><thead><tr><th>字段</th><th>含义</th><th>值类型</th><th>默认值</th></tr></thead><tbody><tr><td>name</td><td>作者名</td><td>String</td><td>config.author</td></tr><tr><td>avatar</td><td>头像</td><td>String</td><td>config.avatar</td></tr><tr><td>url</td><td>链接</td><td>String</td><td>config.url</td></tr></tbody></table><h2 id="8、显示迷你音乐播放器"><a href="#8、显示迷你音乐播放器" class="headerlink" title="8、显示迷你音乐播放器"></a>8、显示迷你音乐播放器</h2><p><strong>标题右边显示迷你音乐播放器，支持的字段有：server、type、id。</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">music:</span><br><span class="line">  server: netease   # netease, tencent, kugou, xiami, baidu</span><br><span class="line">  type: song        # song, playlist, album, search, artist</span><br><span class="line">  id: 16846091      # song id &#x2F; playlist id &#x2F; album id &#x2F; search keyword</span><br><span class="line">---</span><br></pre></td></tr></table></figure><h2 id="9、标题右边显示缩略图"><a href="#9、标题右边显示缩略图" class="headerlink" title="9、标题右边显示缩略图"></a>9、标题右边显示缩略图</h2><p><strong>略图仅在文章列表和文章页面显示，不会在归档页面显示。</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">thumbnail: https:&#x2F;&#x2F;img.vim-cn.com&#x2F;17&#x2F;0c7b02722686d1527a1df807dae0794d995860.png</span><br><span class="line">---</span><br></pre></td></tr></table></figure><h2 id="10、添加彩色滚动变换字体"><a href="#10、添加彩色滚动变换字体" class="headerlink" title="10、添加彩色滚动变换字体"></a>10、添加彩色滚动变换字体</h2><p>转自 <a href="https://itrhx.blog.csdn.net/article/details/85420403" target="_blank" rel="noopener">Hexo博客优化之博客美化系列</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id&#x3D;&quot;binft&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    var binft &#x3D; function (r) &#123;</span><br><span class="line">      function t() &#123;</span><br><span class="line">        return b[Math.floor(Math.random() * b.length)]</span><br><span class="line">      &#125;  </span><br><span class="line">      function e() &#123;</span><br><span class="line">        return String.fromCharCode(94 * Math.random() + 33)</span><br><span class="line">      &#125;</span><br><span class="line">      function n(r) &#123;</span><br><span class="line">        for (var n &#x3D; document.createDocumentFragment(), i &#x3D; 0; r &gt; i; i++) &#123;</span><br><span class="line">          var l &#x3D; document.createElement(&quot;span&quot;);</span><br><span class="line">          l.textContent &#x3D; e(), l.style.color &#x3D; t(), n.appendChild(l)</span><br><span class="line">        &#125;</span><br><span class="line">        return n</span><br><span class="line">      &#125;</span><br><span class="line">      function i() &#123;</span><br><span class="line">        var t &#x3D; o[c.skillI];</span><br><span class="line">        c.step ? c.step-- : (c.step &#x3D; g, c.prefixP &lt; l.length ? (c.prefixP &gt;&#x3D; 0 &amp;&amp; (c.text +&#x3D; l[c.prefixP]), c.prefixP++) : &quot;forward&quot; &#x3D;&#x3D;&#x3D; c.direction ? c.skillP &lt; t.length ? (c.text +&#x3D; t[c.skillP], c.skillP++) : c.delay ? c.delay-- : (c.direction &#x3D; &quot;backward&quot;, c.delay &#x3D; a) : c.skillP &gt; 0 ? (c.text &#x3D; c.text.slice(0, -1), c.skillP--) : (c.skillI &#x3D; (c.skillI + 1) % o.length, c.direction &#x3D; &quot;forward&quot;)), r.textContent &#x3D; c.text, r.appendChild(n(c.prefixP &lt; l.length ? Math.min(s, s + c.prefixP) : Math.min(s, t.length - c.skillP))), setTimeout(i, d)</span><br><span class="line">      &#125;</span><br><span class="line">      var l &#x3D; &quot;&quot;,</span><br><span class="line">      o &#x3D; [&quot;青青陵上柏，磊磊涧中石。&quot;, &quot;人生天地间，忽如远行客。&quot;,&quot;斗酒相娱乐，聊厚不为薄。&quot;, &quot;驱车策驽马，游戏宛与洛。&quot;,&quot;洛中何郁郁，冠带自相索。&quot;,&quot;长衢罗夹巷，王侯多第宅。&quot;,&quot;两宫遥相望，双阙百余尺。&quot;,&quot;极宴娱心意，戚戚何所迫？&quot;].map(function (r) &#123;</span><br><span class="line">      return r + &quot;&quot;</span><br><span class="line">      &#125;),</span><br><span class="line">      a &#x3D; 2,</span><br><span class="line">      g &#x3D; 1,</span><br><span class="line">      s &#x3D; 5,</span><br><span class="line">      d &#x3D; 75,</span><br><span class="line">      b &#x3D; [&quot;rgb(110,64,170)&quot;, &quot;rgb(150,61,179)&quot;, &quot;rgb(191,60,175)&quot;, &quot;rgb(228,65,157)&quot;, &quot;rgb(254,75,131)&quot;, &quot;rgb(255,94,99)&quot;, &quot;rgb(255,120,71)&quot;, &quot;rgb(251,150,51)&quot;, &quot;rgb(226,183,47)&quot;, &quot;rgb(198,214,60)&quot;, &quot;rgb(175,240,91)&quot;, &quot;rgb(127,246,88)&quot;, &quot;rgb(82,246,103)&quot;, &quot;rgb(48,239,130)&quot;, &quot;rgb(29,223,163)&quot;, &quot;rgb(26,199,194)&quot;, &quot;rgb(35,171,216)&quot;, &quot;rgb(54,140,225)&quot;, &quot;rgb(76,110,219)&quot;, &quot;rgb(96,84,200)&quot;],</span><br><span class="line">      c &#x3D; &#123;</span><br><span class="line">        text: &quot;&quot;,</span><br><span class="line">        prefixP: -s,</span><br><span class="line">        skillI: 0,</span><br><span class="line">        skillP: 0,</span><br><span class="line">        direction: &quot;forward&quot;,</span><br><span class="line">        delay: a,</span><br><span class="line">        step: g</span><br><span class="line">      &#125;;</span><br><span class="line">      i()</span><br><span class="line">      &#125;;</span><br><span class="line">      binft(document.getElementById(&#39;binft&#39;));</span><br><span class="line">  &lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><h2 id="11、添加字数统计和阅读时长"><a href="#11、添加字数统计和阅读时长" class="headerlink" title="11、添加字数统计和阅读时长"></a>11、添加字数统计和阅读时长</h2><p><strong>安装以下插件：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save hexo-wordcount</span><br></pre></td></tr></table></figure><p><strong>修改配置文件，将 wordcount 插件打开</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">plugins:</span><br><span class="line">  ...</span><br><span class="line">  # 文章字数统计、阅读时长，开启需要安装插件: npm i --save hexo-wordcount</span><br><span class="line">  wordcount: true</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> BLOG </category>
          
          <category> Volantis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> Volantis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Elasticsearch集群搭建</title>
      <link href="/post/8e68c6bd.html"/>
      <url>/post/8e68c6bd.html</url>
      
        <content type="html"><![CDATA[<p>本文介绍Elasticsearch集群相关原理与配置。</p><a id="more"></a><h2 id="1-安装前准备"><a href="#1-安装前准备" class="headerlink" title="1 安装前准备"></a>1 安装前准备</h2><h2 id="1-1-安装环境"><a href="#1-1-安装环境" class="headerlink" title="1.1  安装环境"></a>1.1  安装环境</h2><p><strong>1.1.1 ElasticSearch简介</strong></p><blockquote><p>为何要搭建 Elasticsearch 集群</p></blockquote><p>凡事都要讲究个为什么。在搭建集群之前，我们首先先问一句，为什么我们需要搭建集群？它有什么优势呢？</p><p><strong>高可用性</strong></p><p>Elasticsearch 作为一个搜索引擎，我们对它的基本要求就是存储海量数据并且可以在非常短的时间内查询到我们想要的信息。所以第一步我们需要保证的就是 Elasticsearch 的高可用性，什么是高可用性呢？它通常是指，通过设计减少系统不能提供服务的时间。假设系统一直能够提供服务，我们说系统的可用性是 100%。如果系统在某个时刻宕掉了，比如某个网站在某个时间挂掉了，那么就可以它临时是不可用的。所以，为了保证 Elasticsearch 的高可用性，我们就应该尽量减少 Elasticsearch 的不可用时间。</p><p>那么怎样提高 Elasticsearch 的高可用性呢？这时集群的作用就体现出来了。假如 Elasticsearch 只放在一台服务器上，即单机运行，假如这台主机突然断网了或者被攻击了，那么整个 Elasticsearch 的服务就不可用了。但如果改成 Elasticsearch 集群的话，有一台主机宕机了，还有其他的主机可以支撑，这样就仍然可以保证服务是可用的。</p><p>那可能有的小伙伴就会说了，那假如一台主机宕机了，那么不就无法访问这台主机的数据了吗？那假如我要访问的数据正好存在这台主机上，那不就获取不到了吗？难道其他的主机里面也存了一份一模一样的数据？那这岂不是很浪费吗？</p><p>为了解答这个问题，这里就引出了 Elasticsearch 的信息存储机制了。首先解答上面的问题，一台主机宕机了，这台主机里面存的数据依然是可以被访问到的，因为在其他的主机上也有备份，但备份的时候也不是整台主机备份，是分片备份的，那这里就又引出了一个概念——分片。</p><p>分片，英文叫做 Shard，顾名思义，分片就是对数据切分成了多个部分。我们知道 Elasticsearch 中一个索引（Index）相当于是一个数据库，如存某网站的用户信息，我们就建一个名为 user 的索引。但索引存储的时候并不是整个存一起的，它是被分片存储的，Elasticsearch 默认会把一个索引分成五个分片，当然这个数字是可以自定义的。分片是数据的容器，数据保存在分片内，分片又被分配到集群内的各个节点里。当你的集群规模扩大或者缩小时， Elasticsearch 会自动的在各节点中迁移分片，使得数据仍然均匀分布在集群里，所以相当于一份数据被分成了多份并保存在不同的主机上。</p><p>那这还是没解决问题啊，如果一台主机挂掉了，那么这个分片里面的数据不就无法访问了？别的主机都是存储的其他的分片。其实是可以访问的，因为其他主机存储了这个分片的备份，叫做副本，这里就引出了另外一个概念——副本。</p><p>副本，英文叫做 Replica，同样顾名思义，副本就是对原分片的复制，和原分片的内容是一样的，Elasticsearch 默认会生成一份副本，所以相当于是五个原分片和五个分片副本，相当于一份数据存了两份，并分了十个分片，当然副本的数量也是可以自定义的。这时我们只需要将某个分片的副本存在另外一台主机上，这样当某台主机宕机了，我们依然还可以从另外一台主机的副本中找到对应的数据。所以从外部来看，数据结果是没有任何区别的。</p><p>一般来说，Elasticsearch 会尽量把一个索引的不同分片存储在不同的主机上，分片的副本也尽可能存在不同的主机上，这样可以提高容错率，从而提高高可用性。</p><p>但这时假如你只有一台主机，那不就没办法了吗？分片和副本其实是没意义的，一台主机挂掉了，就全挂掉了。</p><p><strong>健康状态</strong></p><p>针对一个索引，Elasticsearch 中其实有专门的衡量索引健康状况的标志，分为三个等级：</p><ul><li>green，绿色。这代表所有的主分片和副本分片都已分配。你的集群是 100% 可用的。</li><li>yellow，黄色。所有的主分片已经分片了，但至少还有一个副本是缺失的。不会有数据丢失，所以搜索结果依然是完整的。不过，你的高可用性在某种程度上被弱化。如果更多的分片消失，你就会丢数据了。所以可把 yellow 想象成一个需要及时调查的警告。</li><li>red，红色。至少一个主分片以及它的全部副本都在缺失中。这意味着你在缺少数据：搜索只能返回部分数据，而分配到这个分片上的写入请求会返回一个异常。</li></ul><p>如果你只有一台主机的话，其实索引的健康状况也是 yellow，因为一台主机，集群没有其他的主机可以防止副本，所以说，这就是一个不健康的状态，因此集群也是十分有必要的。</p><p><strong>存储空间</strong></p><p>另外，既然是群集，那么存储空间肯定也是联合起来的，假如一台主机的存储空间是固定的，那么集群它相对于单个主机也有更多的存储空间，可存储的数据量也更大。</p><p>所以综上所述，我们需要一个集群！</p><blockquote><p>详细了解 Elasticsearch 集群</p></blockquote><p>接下来我们再来了解下集群的结构是怎样的。</p><p>首先我们应该清楚多台主机构成了一个集群，每台主机称作一个节点（Node）。</p><p>如图就是一个三节点的集群：</p><p><img src="17B878265DB54D86BC8828F08597C49A" alt="image"></p><p>在图中，每个 Node 都有三个分片，其中 P 开头的代表 Primary 分片，即主分片，R 开头的代表 Replica 分片，即副本分片。所以图中主分片 1、2，副本分片 0 储存在 1 号节点，副本分片 0、1、2 储存在 2 号节点，主分片 0 和副本分片 1、2 储存在 3 号节点，一共是 3 个主分片和 6 个副本分片。同时我们还注意到 1 号节点还有个 MASTER 的标识，这代表它是一个主节点，它相比其他的节点更加特殊，它有权限控制整个集群，比如资源的分配、节点的修改等等。</p><p>这里就引出了一个概念就是节点的类型，我们可以将节点分为这么四个类型：</p><ul><li>主节点：即 Master 节点。主节点的主要职责是和集群操作相关的内容，如创建或删除索引，跟踪哪些节点是群集的一部分，并决定哪些分片分配给相关的节点。稳定的主节点对集群的健康是非常重要的。默认情况下任何一个集群中的节点都有可能被选为主节点。索引数据和搜索查询等操作会占用大量的cpu，内存，io资源，为了确保一个集群的稳定，分离主节点和数据节点是一个比较好的选择。虽然主节点也可以协调节点，路由搜索和从客户端新增数据到数据节点，但最好不要使用这些专用的主节点。一个重要的原则是，尽可能做尽量少的工作。</li><li>数据节点：即 Data 节点。数据节点主要是存储索引数据的节点，主要对文档进行增删改查操作，聚合操作等。数据节点对 CPU、内存、IO 要求较高，在优化的时候需要监控数据节点的状态，当资源不够的时候，需要在集群中添加新的节点。</li><li>负载均衡节点：也称作 Client 节点，也称作客户端节点。当一个节点既不配置为主节点，也不配置为数据节点时，该节点只能处理路由请求，处理搜索，分发索引操作等，从本质上来说该客户节点表现为智能负载平衡器。独立的客户端节点在一个比较大的集群中是非常有用的，他协调主节点和数据节点，客户端节点加入集群可以得到集群的状态，根据集群的状态可以直接路由请求。</li><li>预处理节点：也称作 Ingest 节点，在索引数据之前可以先对数据做预处理操作，所有节点其实默认都是支持 Ingest 操作的，也可以专门将某个节点配置为 Ingest 节点。</li></ul><p>以上就是节点几种类型，一个节点其实可以对应不同的类型，如一个节点可以同时成为主节点和数据节点和预处理节点，但如果一个节点既不是主节点也不是数据节点，那么它就是负载均衡节点。具体的类型可以通过具体的配置文件来设置。</p><p><strong>1.1.2 操作系统</strong></p><p>Red Hat 7.5（64位）</p><p><strong>1.1.3  主机规划</strong></p><table><thead><tr><th>服务类型</th><th>IP地址</th><th>端口</th></tr></thead><tbody><tr><td>ElasticSearch</td><td>172.10.0.13</td><td>9200</td></tr><tr><td>ElasticSearch</td><td>172.10.0.14</td><td>9200</td></tr></tbody></table><p><strong>1.1.4 系统配置说明</strong></p><p>9300端口： ES节点之间通讯使用</p><p>9200端口： ES节点 和 外部 通讯使用</p><p>9300是tcp通讯端口，集群间和TCPClient都走的它；9200是http协议的RESTful接口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone&#x3D;public --add-port&#x3D;9200&#x2F;tcp --permanent</span><br><span class="line">firewall-cmd --zone&#x3D;public --add-port&#x3D;9300&#x2F;tcp --permanent</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure><p><strong>1.1.5 ElasticSearch版本号说明</strong></p><p>ElasticSearch版本为5.6.9。</p><h2 id="2-软件安装"><a href="#2-软件安装" class="headerlink" title="2 软件安装"></a>2 软件安装</h2><h2 id="2-1-安装JDK"><a href="#2-1-安装JDK" class="headerlink" title="2.1 安装JDK"></a>2.1 安装JDK</h2><p>略</p><h2 id="2-2-创建ElasticSearch用户"><a href="#2-2-创建ElasticSearch用户" class="headerlink" title="2.2 创建ElasticSearch用户"></a>2.2 创建ElasticSearch用户</h2><p><strong>2.2.1 使用root用户ssh登录服务器，以172.16.90.43为例</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@172.16.90.43</span><br></pre></td></tr></table></figure><p><strong>2.2.1 创建用户</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd -d &#x2F;home&#x2F;es es</span><br></pre></td></tr></table></figure><p><strong>2.2.1 设置密码</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd es</span><br></pre></td></tr></table></figure><h2 id="2-3-安装ElasticSearch"><a href="#2-3-安装ElasticSearch" class="headerlink" title="2.3 安装ElasticSearch"></a>2.3 安装ElasticSearch</h2><p><strong>2.3.1 创建目录</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p &#x2F;opt&#x2F;yusys&#x2F;elasticsearch</span><br></pre></td></tr></table></figure><p><strong>2.3.2 切换到目录/opt/yusys/elasticsearch</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;opt&#x2F;yusys&#x2F;elasticsearch</span><br></pre></td></tr></table></figure><p><strong>2.3.1 将{上线包}\installPackages\elasticsearch\elasticsearch-5.6.9.tar.gz上传到当前目录</strong></p><p><strong>2.3.2 解压缩elasticsearch-5.6.9.tar.gz</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf elasticsearch-5.6.9.tar.gz</span><br></pre></td></tr></table></figure><p><strong>2.3.3 配置ElasticSearch</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;opt&#x2F;yusys&#x2F;elasticsearch&#x2F;elasticsearch-5.6.9&#x2F;config</span><br><span class="line">vim elasticsearch.yml</span><br></pre></td></tr></table></figure><p>配置参数描述：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">集群的名称</span><br><span class="line">通过 cluster.name 可以配置集群的名称，集群是一个整体，因此名称都要一致，所有主机都配置成相同的名称，配置示例：</span><br><span class="line"></span><br><span class="line">cluster.name: germey-es-clusters</span><br><span class="line">节点的名称</span><br><span class="line">通过 node.name 可以配置每个节点的名称，每个节点都是集群的一部分，每个节点名称都不要相同，可以按照顺序编号，配置示例：</span><br><span class="line"></span><br><span class="line">node.name: es-node-1</span><br><span class="line">其他的主机可以配置为 es-node-2、es-node-3 等。</span><br><span class="line"></span><br><span class="line">是否有资格成为主节点</span><br><span class="line">通过 node.master 可以配置该节点是否有资格成为主节点，如果配置为 true，则主机有资格成为主节点，配置为 false 则主机就不会成为主节点，可以去当数据节点或负载均衡节点。注意这里是有资格成为主节点，不是一定会成为主节点，主节点需要集群经过选举产生。这里我配置所有主机都可以成为主节点，因此都配置为 true，配置示例：</span><br><span class="line"></span><br><span class="line">node.master: true</span><br><span class="line">是否是数据节点</span><br><span class="line">通过 node.data 可以配置该节点是否为数据节点，如果配置为 true，则主机就会作为数据节点，注意主节点也可以作为数据节点，当 node.master 和 node.data 均为 false，则该主机会作为负载均衡节点。这里我配置所有主机都是数据节点，因此都配置为 true，配置示例：</span><br><span class="line"></span><br><span class="line">node.data: true</span><br><span class="line">数据和日志路径</span><br><span class="line">通过 path.data 和 path.logs 可以配置 Elasticsearch 的数据存储路径和日志存储路径，可以指定任意位置，这里我指定存储到 1T 硬盘对应的路径下，另外注意一下写入权限问题，配置示例：</span><br><span class="line"></span><br><span class="line">path.data: &#x2F;datadrive&#x2F;elasticsearch&#x2F;data</span><br><span class="line">path.logs: &#x2F;datadrive&#x2F;elasticsearch&#x2F;logs</span><br><span class="line">设置访问的地址和端口</span><br><span class="line">我们需要设定 Elasticsearch 运行绑定的 Host，默认是无法公开访问的，如果设置为主机的公网 IP 或 0.0.0.0 就是可以公开访问的，这里我们可以都设置为公开访问或者部分主机公开访问，如果是公开访问就配置为：</span><br><span class="line"></span><br><span class="line">network.host: 0.0.0.0</span><br><span class="line">如果不想被公开访问就不用配置。</span><br><span class="line"></span><br><span class="line">另外还可以配置访问的端口，默认是 9200：</span><br><span class="line"></span><br><span class="line">http.port: 9200</span><br><span class="line">集群地址设置</span><br><span class="line">通过 discovery.zen.ping.unicast.hosts 可以配置集群的主机地址，配置之后集群的主机之间可以自动发现，这里我配置的是内网地址，配置示例：</span><br><span class="line"></span><br><span class="line">discovery.zen.ping.unicast.hosts: [&quot;10.0.0.4&quot;, &quot;10.0.0.5&quot;, &quot;10.0.0.6&quot;, &quot;10.0.0.7&quot;, &quot;10.0.0.8&quot;, &quot;10.0.0.9&quot;, &quot;10.0.0.10&quot;]</span><br><span class="line">这里请改成你的主机对应的 IP 地址。</span><br><span class="line"></span><br><span class="line">节点数目相关配置</span><br><span class="line">为了防止集群发生“脑裂”，即一个集群分裂成多个，通常需要配置集群最少主节点数目，通常为 (可成为主节点的主机数目 &#x2F; 2) + 1，例如我这边可以成为主节点的主机数目为 7，那么结果就是 4，配置示例：</span><br><span class="line"></span><br><span class="line">discovery.zen.minimum_master_nodes: 4</span><br><span class="line">另外还可以配置当最少几个节点回复之后，集群就正常工作，这里我设置为 4，可以酌情修改，配置示例：</span><br><span class="line"></span><br><span class="line">gateway.recover_after_nodes: 4</span><br></pre></td></tr></table></figure><p>配置信息如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"># &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Elasticsearch Configuration &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">#</span><br><span class="line"># NOTE: Elasticsearch comes with reasonable defaults for most settings.</span><br><span class="line">#       Before you set out to tweak and tune the configuration, make sure you</span><br><span class="line">#       understand what are you trying to accomplish and the consequences.</span><br><span class="line">#</span><br><span class="line"># The primary way of configuring a node is via this file. This template lists</span><br><span class="line"># the most important settings you may want to configure for a production cluster.</span><br><span class="line">#</span><br><span class="line"># Please consult the documentation for further information on configuration options:</span><br><span class="line"># https:&#x2F;&#x2F;www.elastic.co&#x2F;guide&#x2F;en&#x2F;elasticsearch&#x2F;reference&#x2F;index.html</span><br><span class="line">#</span><br><span class="line"># ---------------------------------- Cluster -----------------------------------</span><br><span class="line">#</span><br><span class="line"># Use a descriptive name for your cluster:</span><br><span class="line">#</span><br><span class="line">cluster.name: crm-es-cluster</span><br><span class="line">#</span><br><span class="line"># ------------------------------------ Node ------------------------------------</span><br><span class="line">#</span><br><span class="line"># Use a descriptive name for the node:</span><br><span class="line">#</span><br><span class="line">node.name: crm-es-node-1</span><br><span class="line">#</span><br><span class="line"># Add custom attributes to the node:</span><br><span class="line">#</span><br><span class="line">#node.attr.rack: r1</span><br><span class="line">#</span><br><span class="line"># ----------------------------------- Paths ------------------------------------</span><br><span class="line"></span><br><span class="line">node.master: true</span><br><span class="line"></span><br><span class="line">node.data: true</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># Path to directory where to store the data (separate multiple locations by comma):</span><br><span class="line">#</span><br><span class="line">path.data: &#x2F;opt&#x2F;yusys&#x2F;elasticsearch&#x2F;elasticsearch-5.6.9&#x2F;data</span><br><span class="line">#</span><br><span class="line"># Path to log files:</span><br><span class="line">#</span><br><span class="line">path.logs: &#x2F;opt&#x2F;yusys&#x2F;elasticsearch&#x2F;elasticsearch-5.6.9&#x2F;logs</span><br><span class="line">#</span><br><span class="line"># ----------------------------------- Memory -----------------------------------</span><br><span class="line">#</span><br><span class="line"># Lock the memory on startup:</span><br><span class="line">#</span><br><span class="line">#bootstrap.memory_lock: true</span><br><span class="line">#</span><br><span class="line"># Make sure that the heap size is set to about half the memory available</span><br><span class="line"># on the system and that the owner of the process is allowed to use this</span><br><span class="line"># limit.</span><br><span class="line">#</span><br><span class="line"># Elasticsearch performs poorly when the system is swapping the memory.</span><br><span class="line">#</span><br><span class="line"># ---------------------------------- Network -----------------------------------</span><br><span class="line">#</span><br><span class="line"># Set the bind address to a specific IP (IPv4 or IPv6):</span><br><span class="line">#</span><br><span class="line">network.host: 0.0.0.0</span><br><span class="line">#</span><br><span class="line"># Set a custom port for HTTP:</span><br><span class="line">#</span><br><span class="line">http.port: 9200</span><br><span class="line">#</span><br><span class="line"># For more information, consult the network module documentation.</span><br><span class="line">#</span><br><span class="line"># --------------------------------- Discovery ----------------------------------</span><br><span class="line">#</span><br><span class="line"># Pass an initial list of hosts to perform discovery when new node is started:</span><br><span class="line"># The default list of hosts is [&quot;127.0.0.1&quot;, &quot;[::1]&quot;]</span><br><span class="line">#</span><br><span class="line">discovery.zen.ping.unicast.hosts: [&quot;172.10.0.13&quot;, &quot;172.10.0.14&quot;]</span><br><span class="line">#</span><br><span class="line"># Prevent the &quot;split brain&quot; by configuring the majority of nodes (total number of master-eligible nodes &#x2F; 2 + 1):</span><br><span class="line">#</span><br><span class="line">discovery.zen.minimum_master_nodes: 1</span><br><span class="line">#</span><br><span class="line"># For more information, consult the zen discovery module documentation.</span><br><span class="line">#</span><br><span class="line"># ---------------------------------- Gateway -----------------------------------</span><br><span class="line">#</span><br><span class="line"># Block initial recovery after a full cluster restart until N nodes are started:</span><br><span class="line">#</span><br><span class="line">gateway.recover_after_nodes: 2</span><br><span class="line">#</span><br><span class="line"># For more information, consult the gateway module documentation.</span><br><span class="line">#</span><br><span class="line"># ---------------------------------- Various -----------------------------------</span><br><span class="line">#</span><br><span class="line"># Require explicit names when deleting indices:</span><br><span class="line">#</span><br><span class="line">#action.destructive_requires_name: true</span><br><span class="line"></span><br><span class="line">http.cors.enabled: true</span><br><span class="line"></span><br><span class="line">http.cors.allow-origin: &quot;*&quot;</span><br></pre></td></tr></table></figure><h2 id="2-4-启动ElasticSearch前准备"><a href="#2-4-启动ElasticSearch前准备" class="headerlink" title="2.4 启动ElasticSearch前准备"></a>2.4 启动ElasticSearch前准备</h2><p><strong>2.4.1 授权</strong></p><p>在root用户下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;opt&#x2F;yusys&#x2F;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown -R es:es elasticsearch</span><br></pre></td></tr></table></figure><p><strong>2.4.2 修改limits.conf</strong></p><p>在root用户下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim &#x2F;etc&#x2F;security&#x2F;limits.conf</span><br></pre></td></tr></table></figure><p>新增如下配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* soft nofile 65536</span><br><span class="line">* hard nofile 65536</span><br><span class="line">* soft nproc 4096</span><br><span class="line">* hard nproc 4096</span><br></pre></td></tr></table></figure><p><strong>2.4.3 修改sysctl.conf</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim &#x2F;etc&#x2F;sysctl.conf</span><br></pre></td></tr></table></figure><p>新增如下配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vm.max_map_count&#x3D;262144</span><br></pre></td></tr></table></figure><p>执行sysctl -p使之生效</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -p</span><br></pre></td></tr></table></figure><h2 id="2-5-ElasticSearch启动、关闭"><a href="#2-5-ElasticSearch启动、关闭" class="headerlink" title="2.5 ElasticSearch启动、关闭"></a>2.5 ElasticSearch启动、关闭</h2><p>切换到es用户，启动</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;opt&#x2F;yusys&#x2F;elasticsearch&#x2F;elasticsearch-5.6.9&#x2F;bin</span><br><span class="line">.&#x2F;elasticsearch -d #-d为后台启动</span><br></pre></td></tr></table></figure><p>关闭</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jps</span><br></pre></td></tr></table></figure><p>输出如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">21584 Elasticsearch</span><br><span class="line">21598 Jps</span><br><span class="line">2543 -- main class information unavailable</span><br></pre></td></tr></table></figure><p>杀掉进程</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -9 21584</span><br></pre></td></tr></table></figure><h2 id="2-6-ElasticSearch集群验证"><a href="#2-6-ElasticSearch集群验证" class="headerlink" title="2.6 ElasticSearch集群验证"></a>2.6 ElasticSearch集群验证</h2><p><strong>2.6.1 查看集群健康状态</strong></p><p>在集群中的任意一台机器上，执行命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl 127.0.0.1:9200&#x2F;_cat&#x2F;health?v</span><br></pre></td></tr></table></figure><p>运行结果如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">epoch      timestamp cluster        status node.total node.data shards pri relo init unassign pending_tasks max_task_wait_time active_shards_percent</span><br><span class="line">1566463404 16:43:24  crm-es-cluster green           2         2      0   0    0    0        0             0                  -                100.0%</span><br></pre></td></tr></table></figure><p>集群的状态（status）：red红表示集群不可用，有故障。yellow黄表示集群不可靠但可用，一般单节点时就是此状态。green正常状态，表示集群一切正常。</p><p>节点数（node.total）：节点数，这里是2，表示该集群有两个节点。</p><p><strong>2.6.2 查看集群的节点</strong></p><p>在集群中的任意一台机器上，执行命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl 127.0.0.1:9200&#x2F;_cat&#x2F;nodes?v</span><br></pre></td></tr></table></figure><p>运行结果如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ip           heap.percent ram.percent cpu load_1m load_5m load_15m node.role master name</span><br><span class="line">172.16.90.41           14          96  27    3.62    3.37     2.46 mdi       *      crm-es-node-1</span><br><span class="line">172.16.90.42           15          96  25    0.00    0.01     0.05 mdi       -      crm-es-node-2</span><br></pre></td></tr></table></figure><p>这些信息中比较重要的是master列，带*星号表明该节点是主节点。带-表明该节点是从节点。</p><p>另外还有heap.percent堆内存使用情况，ram.percent运行内存使用情况，cpu使用情况。</p><h2 id="3-添加IK分词器"><a href="#3-添加IK分词器" class="headerlink" title="3 添加IK分词器"></a>3 添加IK分词器</h2><p><strong>3.1 切换到/opt/yusys/elasticsearch/elasticsearch-5.6.9/plugins</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;opt&#x2F;yusys&#x2F;elasticsearch&#x2F;elasticsearch-5.6.9&#x2F;plugins</span><br></pre></td></tr></table></figure><p><strong>3.2 将{上线包}\installPackages\elasticsearch\elasticsearch-analysis-ik-5.6.9.zip上传到当前目录</strong></p><p><strong>3.3 解压ik分词器</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip elasticsearch-analysis-ik-5.6.9.zip</span><br></pre></td></tr></table></figure><p>将elasticsearch重命名为ik</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv elasticsearch ik</span><br></pre></td></tr></table></figure><p>删除zip文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -f elasticsearch-analysis-ik-5.6.9.zip</span><br></pre></td></tr></table></figure><p>重启es，我们会发现启动时的信息多了一个关于ik的信息，如图所示</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[2019-08-23T16:20:11,471][INFO ][o.w.a.d.Monitor          ] try load config from &#x2F;opt&#x2F;yusys&#x2F;elasticsearch&#x2F;elasticsearch-5.6.9&#x2F;config&#x2F;analysis-ik&#x2F;IKAnalyzer.cfg.xml</span><br><span class="line">[2019-08-23T16:20:11,472][INFO ][o.w.a.d.Monitor          ] try load config from &#x2F;opt&#x2F;yusys&#x2F;elasticsearch&#x2F;elasticsearch-5.6.9&#x2F;plugins&#x2F;ik&#x2F;config&#x2F;IKAnalyzer.cfg.xml</span><br></pre></td></tr></table></figure><h2 id="4-其他"><a href="#4-其他" class="headerlink" title="4 其他"></a>4 其他</h2><h2 id="4-1-参考资料"><a href="#4-1-参考资料" class="headerlink" title="4.1 参考资料"></a>4.1 参考资料</h2><p><a href="https://cloud.tencent.com/developer/article/1189282" target="_blank" rel="noopener">手把手教你搭建一个 Elasticsearch 集群</a></p><p><a href="https://www.cnblogs.com/bixiaoyu/p/9460554.html" target="_blank" rel="noopener">Elasticsearch集群架构的部署和调优</a></p><p><a href="https://blog.csdn.net/qq_33166046/article/details/90113845/" target="_blank" rel="noopener">Linux离线安装ElasticSearch</a></p><p><a href="https://blog.csdn.net/liboyang71/article/details/78553634/" target="_blank" rel="noopener">Linux 安装Elasticsearch和配置ik分词器步骤</a></p>]]></content>
      
      
      <categories>
          
          <category> 中间件 </category>
          
          <category> ES </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中间件 </tag>
            
            <tag> ES </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Thinkpad E545扩展内存条后蓝屏问题解决</title>
      <link href="/post/c9ba378.html"/>
      <url>/post/c9ba378.html</url>
      
        <content type="html"><![CDATA[<p>最近新买了个Thinkpad E545同时我也扩展内存到8G，当时供应商是先做的系统，系统是WIN7 64位，后安装的内存条。当时随便点了点没有发现什么异常情况。</p><a id="more"></a><p>晚上回家后安装各种常用的软件，尤其登陆QQ后，QQ持续性的崩溃，然后电脑不定期蓝屏。当时以为是系统的问题，我就重新用U盘做了一个纯净版的WIN7 64位系统，但是安装的过程中也是一直蓝屏。</p><p>第二天，我去供应商那处理，他们给我换了一个内存条，当时测试了一会没发现问题，回家后又出现蓝屏和不兼容的情况。</p><p>最后我通过度娘和联想客服了解到，内存条分为低压(1.35V)和正常(1.5V)，区别就是内存条上面有编号PC3、PC3L，有PC3字样的就是正常的，有PC3L字样的就是低压的。</p><img src='https://cdn.jsdelivr.net/gh/lhy030320999/CDN-for-blog@master/post/c9ba378/01.jpg' style='width:400px'><img src='https://cdn.jsdelivr.net/gh/lhy030320999/CDN-for-blog@master/post/c9ba378/02.jpg' style='width:400px'><p>我的本子自带的是1.35V的内存条，他们给我装的是1.5V的，所以一直不兼容，更好成1.35V的内存条后立马OK了。。。我的电脑这几天蓝屏了N次，就因为不兼容问题。。。伤啊。。。</p>]]></content>
      
      
      <categories>
          
          <category> 其他 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 蓝屏 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flex ComboBox下拉列表不自动更新解决方法</title>
      <link href="/post/976a6e28.html"/>
      <url>/post/976a6e28.html</url>
      
        <content type="html"><![CDATA[<p>公司系统出现了个BUG，级联查询Combobox时发现下拉列表不自动更新，只更新了选中项，列表却没有更新。<br>经过不懈的努力，终于找到问题的解决方法。</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">this.item.dataProvider &#x3D; this.itemArray;</span><br><span class="line">this.item.dropdown.dataProvider &#x3D; this.itemArray;</span><br></pre></td></tr></table></figure><p>在对组件dataProvider赋值时同时也需要对dropdown.dataProvider重新赋值。这样显示的内容就是正确的了。</p>]]></content>
      
      
      <categories>
          
          <category> WEB前端 </category>
          
          <category> Flex </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java中如何获取spring中配置的properties属性文件内容</title>
      <link href="/post/48dfcf59.html"/>
      <url>/post/48dfcf59.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>本文介绍Java中如何获取spring中配置的properties属性文件内容</p></blockquote><a id="more"></a><p><strong>1、通过spring配置properties文件</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id&#x3D;&quot;propertyConfigurer&quot;</span><br><span class="line">class&#x3D;&quot;com.tjsoft.base.util.CustomizedPropertyPlaceholderConfigurer&quot;&gt;</span><br><span class="line">&lt;property name&#x3D;&quot;ignoreResourceNotFound&quot; value&#x3D;&quot;true&quot; &#x2F;&gt;</span><br><span class="line">&lt;property name&#x3D;&quot;locations&quot;&gt;</span><br><span class="line">&lt;list&gt;</span><br><span class="line">&lt;value&gt;&#x2F;WEB-INF&#x2F;config&#x2F;jdbc.properties&lt;&#x2F;value&gt;</span><br><span class="line">&lt;value&gt;&#x2F;WEB-INF&#x2F;config&#x2F;mail.properties&lt;&#x2F;value&gt;</span><br><span class="line">&lt;value&gt;&#x2F;WEB-INF&#x2F;config&#x2F;system.properties&lt;&#x2F;value&gt;</span><br><span class="line">&lt;&#x2F;list&gt;</span><br><span class="line">&lt;&#x2F;property&gt;</span><br><span class="line">&lt;&#x2F;bean&gt;</span><br></pre></td></tr></table></figure><p><strong>其中class为自己定义的类</strong></p><p><strong>2、自定义类CustomizedPropertyPlaceholderConfigurer</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.Map;</span><br><span class="line">import java.util.Properties;</span><br><span class="line"> </span><br><span class="line">import org.springframework.beans.BeansException;</span><br><span class="line">import org.springframework.beans.factory.config.ConfigurableListableBeanFactory;</span><br><span class="line">import org.springframework.beans.factory.config.PropertyPlaceholderConfigurer;</span><br><span class="line"> </span><br><span class="line">&#x2F;**</span><br><span class="line"> * 自定义PropertyPlaceholderConfigurer返回properties内容</span><br><span class="line"> * </span><br><span class="line"> * @author LHY 2012-02-24</span><br><span class="line"> * </span><br><span class="line"> *&#x2F;</span><br><span class="line">public class CustomizedPropertyPlaceholderConfigurer extends</span><br><span class="line">PropertyPlaceholderConfigurer &#123;</span><br><span class="line"> </span><br><span class="line">private static Map&lt;String, Object&gt; ctxPropertiesMap;</span><br><span class="line"> </span><br><span class="line">@Override</span><br><span class="line">protected void processProperties(</span><br><span class="line">ConfigurableListableBeanFactory beanFactoryToProcess,</span><br><span class="line">Properties props) throws BeansException &#123;</span><br><span class="line">super.processProperties(beanFactoryToProcess, props);</span><br><span class="line">ctxPropertiesMap &#x3D; new HashMap&lt;String, Object&gt;();</span><br><span class="line">for (Object key : props.keySet()) &#123;</span><br><span class="line">String keyStr &#x3D; key.toString();</span><br><span class="line">String value &#x3D; props.getProperty(keyStr);</span><br><span class="line">ctxPropertiesMap.put(keyStr, value);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">public static Object getContextProperty(String name) &#123;</span><br><span class="line">return ctxPropertiesMap.get(name);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>这样就可以通过CustomizedPropertyPlaceholderConfigurer类来获取properties属性文件中的内容了</strong></p><p><strong>3、如何获取属性文件的内容</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String host &#x3D;  (String) CustomizedPropertyPlaceholderConfigurer.getContextProperty(&quot;mail.smtp.host&quot;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JAVA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flex自定义虚线</title>
      <link href="/post/dde9807b.html"/>
      <url>/post/dde9807b.html</url>
      
        <content type="html"><![CDATA[<p>通过Flex画虚线</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">package com.tjsoft.utils</span><br><span class="line">&#123;</span><br><span class="line">import mx.core.UIComponent;</span><br><span class="line"></span><br><span class="line">public class GraphicsUtil</span><br><span class="line">&#123;</span><br><span class="line">public function GraphicsUtil()</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * 画虚线</span><br><span class="line"> *  @param u 指定画虚线的容器</span><br><span class="line"> *  @param w 指定虚线的长度(间距)</span><br><span class="line"> *  @param uw 指定所画虚线的总长度</span><br><span class="line"> *  @author LHY 2011-11-11</span><br><span class="line"> *&#x2F;</span><br><span class="line">public static  function drawVirtualLine(u:UIComponent,w:Number,uw:Number):void</span><br><span class="line">&#123;</span><br><span class="line">u.graphics.clear();&#x2F;&#x2F;清除绘制到此 Graphics 对象的图形，并重置填充和线条样式设置。</span><br><span class="line">u.graphics.lineStyle(1,0xa0a4a7,1);&#x2F;&#x2F;指定一种线条样式</span><br><span class="line">var width:Number&#x3D;0;</span><br><span class="line">var i:int &#x3D; 0;</span><br><span class="line">while(width&lt;uw)&#123;</span><br><span class="line">u.graphics.moveTo(0+2*w*i,0);</span><br><span class="line">u.graphics.lineTo(0+w+2*w*i,0);</span><br><span class="line">width+&#x3D;w*2;</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WEB前端 </category>
          
          <category> Flex </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flex设置DataGrid单元格颜色以及表头背景颜色渐变</title>
      <link href="/post/ddb6ceb4.html"/>
      <url>/post/ddb6ceb4.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>本文介绍Flex设置DataGrid单元格颜色以及表头背景颜色渐变</p></blockquote><a id="more"></a><p><strong>1、 设置DataGrid单元格颜色</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">package com.tjsoft.base.common.page</span><br><span class="line">&#123;</span><br><span class="line">import flash.display.Sprite;</span><br><span class="line">import mx.controls.DataGrid;</span><br><span class="line">public class ColorsDataGrid extends DataGrid</span><br><span class="line">&#123;</span><br><span class="line">public function ColorsDataGrid()</span><br><span class="line">&#123;</span><br><span class="line">super();</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * </span><br><span class="line"> * 设置单元格背景颜色</span><br><span class="line"> * </span><br><span class="line"> * *&#x2F;</span><br><span class="line">override protected function drawRowBackground(s:Sprite, rowIndex:int, y:Number, height:Number, color:uint, dataIndex:int):void</span><br><span class="line">&#123;</span><br><span class="line">if(rowIndex%2&#x3D;&#x3D;1)</span><br><span class="line">&#123;</span><br><span class="line">color&#x3D;0xffffff;&#x2F;&#x2F;偶数行</span><br><span class="line">&#125;else&#123;</span><br><span class="line">color&#x3D;0xefefef;&#x2F;&#x2F;奇数行</span><br><span class="line">&#125; super.drawRowBackground(s,rowIndex,y,height,color,dataIndex);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2、 设置DataGrid表头背景颜色渐变</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Bindable]  </span><br><span class="line">private var backgroundColorFareArray:Array &#x3D; [0x1d72c1,0xb8e9fb];</span><br><span class="line">在DataGrid组件中设置headerColors&#x3D;&quot;&#123;backgroundColorFareArray&#125;&quot;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WEB前端 </category>
          
          <category> Flex </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flex </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
